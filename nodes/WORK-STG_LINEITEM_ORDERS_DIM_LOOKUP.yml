steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-b5985a1c-ede7-4c8a-b31e-201cee0a12b5:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: ca705afb-707d-4ac9-91d6-31fd9fd72f1c
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 06e5bae9-3e4d-4d3c-8e5f-65cdc21e69ca
                    stepCounter: 390a36e3-76d8-40fe-b29d-3f60424493fd
                transform: ""
          - columnReference:
              columnCounter: c4fcb61e-8493-4e57-92dc-7250ada23290
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d8848cd7-7c9a-4ed2-9000-a37e89d9055b
                    stepCounter: dbf3b918-e394-43ec-b872-0ce4e68a1f69
                transform: ""
          - columnReference:
              columnCounter: cc7cbfe0-21f5-402e-a50c-a8474cc241f7
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9fe2f0dd-8cb6-45f0-8d60-56e636af6797
                    stepCounter: fcabf692-0e2d-4cdf-99a1-144195c36849
                transform: ""
          - columnReference:
              columnCounter: 866f5c3e-e1bd-46d3-a116-9c59a41a4d6c
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 75859bc2-2f0e-4366-ae49-6dbc44927996
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 4cf7a4e5-e98e-4e1c-aa9d-67588230b633
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ea0cd8e5-80f9-4836-893b-60451f1bfa32
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 60178139-054f-496d-922f-b8420af6bd7e
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 33a15815-5908-471e-bfd7-f1ae7d47accb
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 9697b526-8d1f-4cec-a834-a18ea5d7de9a
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c0588ad0-2368-49b4-9ab4-b95d91ff0358
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: a5c25914-5e0f-484c-a571-a3b60c50df30
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: aa81c3ce-fc21-40b8-a031-316f74140ad9
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: a56e2525-4120-4669-920b-4b339323d6fa
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f89caf3d-8c21-4812-b913-00d4fbb211cb
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: a66d6d2c-f4f3-4a47-af4f-d134f123c386
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 819d8262-cd26-43f8-b425-e1c0c6f1c992
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 8ca47d02-4454-45af-a67e-310ecaa71012
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b0dd90ee-14b0-4010-ba90-dffc218076a3
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 7d405059-eda2-4633-a902-d3f15ee27cd5
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a7166cf9-9e7b-4689-b2e7-8cb3141eb519
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: bc968520-8d3c-4b82-ab4c-28ddc5e9b2c1
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d69c4a8e-9f32-4808-9160-cb9aee261a74
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: c33f4bc3-bbf1-4d1b-b592-801cd2572ed4
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e37d8274-f0e6-4dd8-ab46-ad3b3d50fc00
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: e78c024c-7b52-4b97-8720-0a221d0b145e
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6b07028e-39f5-4c6e-a5ef-5d553eab33a3
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 9e12a883-306b-4b59-a5bd-96c7e62430b2
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 38d0b84b-3e7c-41cc-b797-da78de62da29
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 1b54a093-10f9-445b-8f96-d92f442480ad
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ff150c3c-7d4b-47ad-ae7c-6f1a70a3efe8
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: a7ff72c5-2dc9-4d10-b4d7-b4f52c96348b
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 56c33d70-6c96-4537-a9ab-23a6e22b2311
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 60a88618-2dbf-4c52-ad29-5de35792b101
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 32bc0d42-adf7-4464-9657-195d230b0fb3
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 3a100919-5629-4ec0-9dea-a178fb2f1b5b
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7620bcb9-b9ab-4b8d-ab08-4bc0a61e8b6c
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 7fe65efc-7504-4e0a-8567-5f8f96caf27c
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6477e063-0dd5-4f2c-8e08-523adb0fa599
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 407353ce-9044-4d3e-bd34-856890ee0d34
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ec94311e-207e-48f2-8b86-c10bf5b976d0
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: c5c10fe6-9c96-4eec-94a9-a0d5a42c6cc7
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ac458932-d73d-43e0-b1a9-3678a6ff79de
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 2807cbde-a82e-4b83-815c-9f4ad624e479
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0e43707c-e4d4-4a81-a4ff-c7afdd6e445f
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 2b189b8c-1fdc-488f-bf4d-172c33c6d556
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ccd94ac6-1116-4ea1-b6d3-c21b6948b517
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 2d07fef9-8b06-40e7-a830-90b7889ba434
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a78a0e5d-1b4c-477a-a0c7-536af9ffd018
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 0185c943-e114-4316-a253-0c4a08a99fa0
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9a26a73c-d200-42e0-b40d-b38d99a60efb
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 70101251-1721-4bd7-aab4-494f7aca5214
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 61fecc02-a662-479a-8083-d225ec82a957
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: ef1931a6-9f5d-4b3b-a612-c44b9df152b0
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 02ee19fd-7e4f-4e02-b11b-04a765abd11d
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - columnReference:
              columnCounter: 1dfb3b9e-a755-4774-b61f-8857ea61bd62
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS_TO_SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f7e423d9-a807-48ce-98d7-90a75f236e6d
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: e3da9bec-ccfe-4d9a-b1e7-0d68a58e985c
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b7a768c7-abb4-4819-aed3-925ef2a442ef
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: db19fdcc-7c42-4bc4-90b3-71e5c8cc132e
              stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: eef4a9b4-c6b6-4a78-8b75-08bdd13d38e0
                    stepCounter: df8e65cd-f791-462f-90c3-cae1ffba6bbd
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 390a36e3-76d8-40fe-b29d-3f60424493fd
              DIM_PART: dbf3b918-e394-43ec-b872-0ce4e68a1f69
              DIM_SUPPLIER: fcabf692-0e2d-4cdf-99a1-144195c36849
              STG_LINEITEM_ORDERS: df8e65cd-f791-462f-90c3-cae1ffba6bbd
              STG_PARTSUPP: 283ba4d5-1e23-49dc-a7bc-cb520772d1d4
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                
                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: b5985a1c-ede7-4c8a-b31e-201cee0a12b5
